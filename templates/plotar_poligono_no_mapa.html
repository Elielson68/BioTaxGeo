<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mapa</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    
    <link rel="stylesheet" type="text/css" href="../static/css/style.css"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCNEzVQus5NRrbNeVKppxbEy7nKre_0Djc&libraries=geometry"></script>
</head>
<body>
    <!--NAVBAR inserido no caralho do git-->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">SpecieGeo</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="/">Home</a>
            </li>
            <li class="nav-item active">
              <a class="nav-link" href="mapa">Mapa</a>
            </li>
          </ul>
        </div>
      </nav>
      <!--NAVBAR -->
    <div id="mapa_plotar"></div>
<div>
  <script type="text/javascript" src="../static/js/markers.js"></script>
  <script src="../static/js/Jquery.js" type="text/javascript"></script>
  <script>
    var map;
    function MapaDois() {
      var belem = {lat:-1.44502, lng: -48.4650};
      map = new google.maps.Map(document.getElementById('mapa_plotar'), {zoom: 4, center: belem});
      var poligonos_vertices = "{{poligonos}}";
      poligonos_vertices = poligonos_vertices.replace(/&#39;/g,'"');
      poligonos_vertices = JSON.parse(poligonos_vertices);
      poligonos = [];
      var latitude = "{{latitude}}";
      latitude = JSON.parse(latitude);
      var longitude = "{{longitude}}";
      longitude = JSON.parse(longitude);
      var markers = [];

      for (var poligono in poligonos_vertices){
        var Poligono = new google.maps.Polygon({
          strokeColor: '#FF0000',
          strokeOpacity: 0.8,
          strokeWeight: 2,
          fillColor: '#2F4F4F',
          fillOpacity: 0.35,
        })
        poligonos.push(Poligono)
        for (var vertice of poligonos_vertices[poligono]){
          coordenada = new google.maps.LatLng(vertice["lat"], vertice["lng"]);
          poligonos[poligonos.length-1].getPath().push(coordenada);
          
        }
      }

      for(var poli in poligonos){
        poligonos[poli].setMap(map);
        Criar_THead(parseInt(poli)+1);
      }
      Detectar_Marks(latitude, longitude, markers, poligonos);
  }
  </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCNEzVQus5NRrbNeVKppxbEy7nKre_0Djc&callback=MapaDois"></script>
  <table class="table" id="tabela"></table>
</div>
</body>
</html>